<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lab 1 | Fast Robots</title>
  <link rel="stylesheet" href="../../style.css" />
  <style>
    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin: 16px 0 10px;
    }

    .back-button {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      text-decoration: none;
      border-radius: 10px;
      font-size: 14px;
    }

    .back-button:hover { text-decoration: none; filter: brightness(1.05); }

    .muted { color: var(--muted); }

    .media {
      background: rgba(255,255,255,0.04);
      border: 1px dashed var(--border);
      border-radius: 12px;
      padding: 12px;
      margin: 10px 0 16px;
    }

    h2 {
      margin-top: 28px;
      padding-top: 10px;
      border-top: 1px solid var(--border);
    }

    .video-wrap {
      position: relative;
      width: 100%;
      padding-top: 56.25%;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid var(--border);
      background: #000;
      margin: 10px 0 16px;
    }

    .video-wrap iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    .footer {
      margin-top: 26px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      font-size: 14px;
    }
    .img-small {
      max-width: 520px;
      width: 100%;
      height: auto;
      display: block;
      margin: 10px auto 6px;
      border-radius: 10px;
      border: 1px solid var(--border);
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="topbar">
      <!-- Adjust this path based on where you put lab1.html -->
      <a class="back-button" href="../../index.html">← Back to Main Page</a>
      <span class="muted">Fast Robots | Spring 2026</span>
    </div>

    <h1>Lab 1(not completed)</h1>
    <p class="subtitle">Artemis setup + BLE communication (Lab 1A and Lab 1B)</p>

    <!-- ===================== -->
    <!-- ====== LAB 1A ======= -->
    <!-- ===================== -->
    <h2 id="lab1a">Lab 1A</h2>

    <div class="card">
      <h3>Objective</h3>
      <p>
        The purpose of Lab 1A is to set up and become familiar with the Arduino IDE and the Artemis board.
      </p>
    </div>

    <div class="card">
      <h3>Setup</h3>
      <p>
        The Arduino IDE and SparkFun Apollo3 board package were installed and updated on my local machine.
        The SparkFun RedBoard Artemis Nano was selected as the active board and successfully connected via USB.
        I verified correct operation using example sketches and confirmed that all inputs operate at 3.3 V logic.
      </p>

    </div>

    <div class="card">
      <h3>Tasks</h3>

      <h4>Task 1: Blink</h4>
      <p>
        A basic blink sketch was uploaded to verify correct board configuration and GPIO operation.
      </p>
      <div class="video-wrap">
        <iframe src="https://www.youtube.com/embed/vPq3t8IqA-8" allowfullscreen></iframe>
      </div>

      <h4>Task 2: Serial Communication</h4>
      <p>
        Serial communication was tested using the Arduino Serial Monitor and the board successfully
        transmitted formatted messages at the specified baud rate. 
      </p>
      <img src="Serial.png" alt="Serial Monitor output showing successful communication">

      <h4>Task 3: Temperature Sensor</h4>
      <p>
        The onboard temperature sensor was read using analog input. Measured values changed
        in response to touch and ambient conditions as shown in the video.
      </p>
      <div class="video-wrap">
        <iframe src="https://www.youtube.com/embed/QgsjnWiClSM" allowfullscreen></iframe>
      </div>

      <h4>Task 4: Microphone</h4>
      <p>
        The microphone was used to detect sound intensity and dominant frequency components, 
        Changes in the output were observed when I change the frequency. 
      </p>
      <div class="video-wrap">
        <iframe src="https://www.youtube.com/embed/bq4Tn3G5i3s" allowfullscreen></iframe>
      </div>

      <h4>Task 5: Electric Tuning</h4>
      <p>
        I combined microphone readout with serial output to create a simplified electronic tuner.
        The program detected and reported different dominant frequencies in real time.
      </p>
      <div class="video-wrap">
        <iframe src="https://www.youtube.com/embed/vsboKM0xSfU" allowfullscreen></iframe>
      </div>

    </div>

    <div class="card">
      <h3>Conclusion</h3>
      <p>
        In this lab, I set up the Arduino IDE and learned how to use the Artemis Nano board.
        I tested basic functions such as blinking an LED, using the serial monitor, and reading
        data from the temperature sensor and microphone. This lab helped me understand the board
        and prepared me for later labs involving sensing and communication.
      </p>
    </div>




    <!-- ===================== -->
    <!-- ====== LAB 1B ======= -->
    <!-- ===================== -->
    <h2 id="lab1b">Lab 1B</h2>

    <div class="card">
      <h3>Objective</h3>
      <p>
        The purpose of Lab 1B is to establish communication between computer and the Artemis board through the Bluetooth stack. 
      </p>
    </div>

    <div class="card">
      <h3>Prelab</h3>

      <h4>Setup</h4>
      <p>
        The goal of the prelab was to prepare both the laptop and the RedBoard Artemis Nano for Bluetooth Low Energy (BLE) communication using the provided lab codebase. On the laptop, I created a Python environment and installed the BLE-related packages required to run the Jupyter notebook workflows.
      </p>
      
      <p>
        On the Artemis side, I uploaded the provided <code>ble_arduino.ino</code> sketch using the Arduino IDE. This sketch initializes the ArduinoBLE library, defines the BLE service and characteristics, and prepares the board to advertise over BLE.
      </p>
      
      <p>
        After uploading the sketch, the Artemis began advertising and printed its BLE MAC address to the Serial Monitor (picture below). This confirmed that BLE was initialized correctly and that the board was discoverable.
      </p>
      
      <img class="img-small" src="mac.png" alt="Serial Monitor showing Artemis BLE MAC address">
     
      
      <div style="margin-top: 28px;"></div>
      
      <h4>Configuration</h4>
      <p>
        Before attempting a BLE connection, I configured the identifiers needed for the laptop to communicate with the correct Artemis board and BLE interface.
      </p>
      
      <p>
        I generated a unique BLE <strong>service UUID</strong> in Python using <code>uuid4()</code>. This service UUID was then copied into both the Arduino sketch (<code>ble_arduino.ino</code>) and the Python configuration file (<code>connection.yaml</code>). Using a unique service UUID prevents conflicts with other students’ BLE devices in the lab.
      </p>
      
      <img class="img-small" src="jp.png" alt="uuid4() used to generate a BLE service UUID">
      <p class="muted">
        Generating a unique BLE service UUID in Python using <code>uuid4()</code>.
      </p>
      
      <p>
        The BLE service exposes three characteristics that define how data moves between the laptop and the Artemis:
      </p>
      
      <ul>
        <li><code>TX_CMD_STRING</code>: laptop → Artemis (write). Used to send command strings from Python.</li>
        <li><code>RX_STRING</code>: Artemis → laptop (notify/read). Used for string replies and streamed data.</li>
        <li><code>RX_FLOAT</code>: Artemis → laptop (notify/read). Used for numeric data.</li>
      </ul>
      
      <p>
        These characteristic UUIDs are defined in <code>ble_arduino.ino</code> so the Artemis advertises the expected BLE interface.
      </p>
      
      <img class="img-small" src="inosketch.png" alt="Arduino sketch showing BLE service and characteristic UUID definitions">
      
      
      <p>
        I then updated <code>connection.yaml</code> with the Artemis MAC address, service UUID, and characteristic UUIDs so the Python client could identify and connect to the correct BLE device.
      </p>
      
      <img class="img-small" src="yamlsk.png" alt="connection.yaml showing Artemis address, BLE service UUID, and characteristic UUIDs">
      
      
      <div style="margin-top: 28px;"></div>
      
      <h4>Code Base</h4>
      <p>
        The provided BLE codebase consists of two main components: an Arduino sketch running on the Artemis (acting as a BLE peripheral) and a Python notebook/client running on the laptop (acting as a BLE central).
      </p>
      
      <p>
        The Artemis advertises a BLE service and characteristics defined in <code>ble_arduino.ino</code>. The Python client reads the MAC address and UUID information from <code>connection.yaml</code>, initializes a BLE controller, and connects to the Artemis:
      </p>
      
      <pre><code class="language-python"># Get Artemis BLE controller
      ble = get_ble_controller()
      
      # Connect to the Artemis device
      ble.connect()</code></pre>
      
      <p>
        Once the connection succeeded, the Arduino Serial Monitor printed the central device address (picture below), confirming that the laptop successfully connected to the Artemis over BLE.
      </p>
      <img class="img-small" src="connected.png" alt="connected to address">     
      <p>
        After connecting, the laptop sends commands by writing to <code>TX_CMD_STRING</code>. The Artemis checks for incoming writes, parses the command, executes the corresponding handler, and returns results by writing to <code>RX_STRING</code>, which the laptop can read directly or receive asynchronously using BLE notifications.
      </p>
      
      
    







    <div class="card">
      <h3>Tasks</h3>

      <h4>Task 1: ECHO Command</h4>

      <h5>Goal</h5>
      <p>
        Send a string from the laptop to the Artemis using the <code>ECHO</code> command, then read back an
        “augmented” reply from the Artemis over the BLE string characteristic.
      </p>

      <h5>Implementation</h5>
      <p>
        From Python (Jupyter), I sent a test payload using:
      </p>
      <pre><code class="language-python">ble.send_command(CMD.ECHO, "HiHello")</code></pre>

      <p>
        On the Artemis side, the command is received through the writeable command characteristic, parsed by
        <code>RobotCommand</code>, and the next token (the string) is extracted into <code>char_arr</code>. I then built
        the response using <code>EString</code> and wrote it back to the BLE TX string characteristic.
      </p>

      <h5>Relevant Code Snippet (Arduino)</h5>
      <pre><code class="language-cpp">case ECHO:
  char char_arr[MAX_MSG_SIZE];
  success = robot_cmd.get_next_value(char_arr);
  if (!success) return;

  tx_estring_value.clear();
  tx_estring_value.append("Robot says -> ");
  tx_estring_value.append(char_arr);
  tx_estring_value.append(" :)");
  tx_characteristic_string.writeValue(tx_estring_value.c_str());

  Serial.print("Echo reply: ");
  Serial.println(tx_estring_value.c_str());
  break;</code></pre>

      <h5>Results</h5>
      <p>
        After sending <code>HiHello</code> from Python, the laptop received the modified reply
        <code>Robot says -> HiHello :)</code>. The Serial Monitor also confirmed the command reception and the
        generated reply.
      </p>

      <img class="img-small" src="echo.png" alt="Serial monitor showing RX wrote and Echo reply for the ECHO command">
      <p class="muted">Serial Monitor output for the ECHO command (received payload and augmented reply).</p>






      <h4>Task 2: GET_TIME_MILLIS</h4>
      <p><!-- Artemis replies with T:123456 --></p>

      <h4>Task 3: Notification Handler</h4>
      <p><!-- Callback parses time from T:... --></p>

      <h4>Task 4: Time Streaming and Data Rate</h4>
      <p>
        <!-- Describe: stream timestamps for N seconds, count messages,
             compute messages/sec and KiB/sec -->
      </p>

      <div class="media">
        <strong>Results:</strong>
        <ul>
          <li>Duration: <!-- e.g. 5.0 s --></li>
          <li>Messages received: <!-- N --></li>
          <li>Message rate: <!-- N/duration --></li>
          <li>Payload size per message: <!-- e.g. len("T:123456") bytes --></li>
          <li>Effective payload rate: <!-- bytes/sec and KiB/sec --></li>
        </ul>
      </div>

      <h4>Relevant Code Snippets</h4>
      <p class="muted">haha</p>

      <pre><code>// Arduino: case GET_TIME_MILLIS / GET_TIME_RATE </code></pre>
      <pre><code># Python: notify handler + rate calculation </code></pre>
    </div>





    <div class="card">
      <h3>Conclusion</h3>
      <p>
        <!-- What you learned, biggest debugging issue, how you solved it -->
      </p>
    </div>

    <div class="footer">
      <a class="back-button" href="../../index.html">← Back to Main Page</a>
      <span>Last updated: <!-- optional date --></span>
    </div>
  </div>
</body>
</html>