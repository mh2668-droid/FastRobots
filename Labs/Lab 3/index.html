<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lab 3 | Fast Robots</title>
  <link rel="stylesheet" href="../../style.css" />
  <!-- MathJax for LaTeX equations -->
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin: 16px 0 10px;
    }

    .back-button {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      text-decoration: none;
      border-radius: 10px;
      font-size: 14px;
    }

    .back-button:hover { text-decoration: none; filter: brightness(1.05); }

    .muted { color: var(--muted); }

    .media {
      background: rgba(255,255,255,0.04);
      border: 1px dashed var(--border);
      border-radius: 12px;
      padding: 12px;
      margin: 10px 0 16px;
    }

    h2 {
      margin-top: 28px;
      padding-top: 10px;
      border-top: 1px solid var(--border);
    }

    .video-wrap {
      position: relative;
      width: 100%;
      padding-top: 56.25%;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid var(--border);
      background: #000;
      margin: 10px 0 16px;
    }

    .video-wrap iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    .footer {
      margin-top: 26px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      font-size: 14px;
    }
    .img-small {
      max-width: 520px;
      width: 100%;
      height: auto;
      display: block;
      margin: 10px auto 6px;
      border-radius: 10px;
      border: 1px solid var(--border);
    }

    .img-medium {
      max-width: 800px;
      width: 100%;
      height: auto;
      display: block;
      margin: 10px auto 6px;
      border-radius: 10px;
      border: 1px solid var(--border);
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="topbar">
      <!-- Adjust this path based on where you put lab1.html -->
      <a class="back-button" href="../../index.html">← Back to Main Page</a>
      <span class="muted">Fast Robots | Spring 2026</span>
    </div>

    <h1>Lab 3: Time of Flight Sensors</h1>
   
    <div class="card">
      <h3>Objective</h3>
      <p>
        The goal of this lab is to add distance sensors to the robot and collect fast, reliable measurements so it can detect obstacles and navigate safely.
      </p>
    </div>

    <div class="card">
      <h3>Pre Lab</h3>
      <p>
        To detect obstacles in multiple directions, I will use two VL53L1X ToF sensors on the robot. Since both sensors power up with the same default I2C address (0x29),
         they cannot be used at the same time without changing one of their addresses.
         To solve this, I wired the XSHUT pin of one sensor to Artemis GPIO pin A2. During startup, 
         the Artemis pulls this pin LOW to turn that sensor off, initializes the other sensor at 0x29, changes its address to 0x20, 
         and then turns the second sensor back on. This will allow both sensors to run at the same time on the same I2C bus.
      </p>
      <p>
        For placement, one sensor will be mounted at the front of the robot to detect obstacles directly ahead, while the second sensor will be mounted on the side to monitor nearby 
        walls and objects when turning or navigating tight spaces. This setup provides better awareness than pointing both sensors forward.
      </p>


    </p>
    <img class="img-medium" src="wiring.png" alt="connection imu">
    <p>
      <p>
        The picture above shows the wiring diagram. Both sensors share power, ground, SDA, and SCL through the Qwiic multipoint hub. I used detachable Qwiic connections for the I2C lines to make the sensors easy to remove, 
        while the XSHUT control wire was soldered to A2 for a secure connection. Wire lengths were planned to reach the final mounting positions without tension as well as avoid moving parts and reduce strain on the solder joints.
      </p>
    </div>


    <div class="card">
      <h3>Tasks</h3>

      <div class="card">


      <h4>1. Battery</h4>
      <p>
        To power the Artemis without a USB connection, I soldered a JST connector to a 3.7 V Li-Po battery and used it as the primary power source. 
        The battery wires were cut and soldered one at a time, and heat shrink tubing was applied to insulate the exposed connections and provide strain relief. 
        But when connecting the JST lead to the Artemis power port, I noticed that the polarity labeling on the board was reversed relative to the battery lead orientation. 
        Then I swapped the red and black wires and resoldered the connection. 
        
      </p>
    

      </p>
      <img class="img-small" src="battery.png" alt="">
      <p>  
        To confirm that the Artemis was functioning correctly while powered only by the battery,
         I connected to the device over Bluetooth and used the ECHO command from Lab 1. 
       
      </p>
       <p>
        <img class="img-medium" src="ble.png" alt="   ">
         </p>


     </div>



    <div class="card">

     <h4>2. First TOF setup </h4>

        <p>
            To set up the first ToF sensor, I connected the VL53L1X breakout board to the Qwiic multipoint hub using a modified Qwiic cable. One end of the cable was cut and the wires were soldered directly to the sensor pads. 
            The wire colors were matched to the I2C connections as follows:
            •	Red → VIN (power)
            •	Black → GND
            •	Blue → SDA
            •	Yellow → SCL
        </p>


        <p>
        <img class="img-sm" src="con.png" alt="   ">
        </p>


        <p>
            After wiring the first ToF sensor, I scanned the I2C bus using the Example05_wire_I2C example from the Apollo3 Wire library. The scan detected a device at address 0x29, shows that the sensor was properly connected and communicating. Although the VL53L1X datasheet lists the default address as 0x52, this value includes the read/write bit. The actual 7-bit I2C device address is obtained by shifting 0x52 one bit to the right, 0x52 = 01010010, and the 7-bit address for 0x29 is  00101001.
            Therefore, the detected address of 0x29 matches the expected default address of the sensor.
        </p>

        <p>
            <img class="img-medium" src="1tof.png" alt="   ">
        </p>
    </div>


    <div class="card">

    <h4>3. TOF Testing </h4>

        <p>
            
        </p>

        <p>
            <img class="img-medium" src="tof.png" alt="   ">
        </p>





        

    </div>
</div>















    <div class="card">
      <h3>Conclusion</h3>
      <p>
        In this lab, I used the Artemis IMU to estimate orientation and see how real sensor data behaves. I used FFT and filtering to deal with noise, and a complementary filter to reduce drift while keeping fast response. I also logged 5 seconds of IMU data onboard and sent it over BLE for analysis. Overall, this lab made IMU sensing feel a lot more practical, and I’m ready to use it in later labs.

      </p>
        
        
                
    </div>

    <div class="footer">
      <a class="back-button" href="../../index.html">← Back to Main Page</a>
    </div>
  </div>
</body>
</html>